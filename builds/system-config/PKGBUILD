pkgbase=system-config
pkgname=(
  'system-config-light'
  'system-config-dark'
)
pkgver=204
pkgrel=1
pkgdesc='System configurations'
url='https://sr.ht/~tardypad/arch-system'
arch=('any')
license=('custom')

groups=(
  'tardypad'
)

conflicts=(
  'system-config'
)

provides=(
  'system-config'
)

replaces=(
  'system-config'
)

install=system-config.install

# base installation
depends=(
  base
  linux
  linux-firmware
  efibootmgr
  grub
  intel-ucode
  os-prober
)

# dotfiles
depends+=(
  aerc
  amfora
  aria2
  bemenu-wayland
  bluez-tools
  bluez-utils
  catimg
  ctags
  curl
  entr
  fontconfig
  foot
  fzf
  gammastep
  git
  gnupg
  grim
  htop
  httpie
  i3blocks
  imagemagick
  imv
  jq
  khard
  less
  libpulse
  libqalculate
  libxml2
  light
  mako
  mpc
  mpd
  mpv
  networkmanager
  opendoas
  openssh
  otf-font-awesome
  pass
  pulsemixer
  pv
  qrencode
  qutebrowser
  remind
  ripgrep
  rsync
  scdoc
  sfeed
  slurp
  sway
  swayidle
  swaylock
  tmux
  tmux-xpanes
  translate-shell
  vdirsyncer
  vim
  w3m
  weechat
  wf-recorder
  wl-clipboard
  xdg-utils
  ydotool
  yubikey-manager
  zathura
  zsh
)

# dotfiles plugins
depends+=(
  vim-ale
  vim-go
  vim-goyo-git
  vim-gutentags-git
  vim-nerdcommenter
  vim-oscyank-git
  vim-repeat
  vim-sayonara-git
  vim-surround
  vim-taboo-git
  vim-tagbar
  vim-tmux-navigator-git
  vim-ultisnips
  vim-undotree
  weechat-vimode-git
  weechat-wee-most-git
  zsh-autosuggestions
  zsh-history-substring-search
  zsh-syntax-highlighting
)

# development
depends+=(
  fakeroot
  gcc
  make
  patch
  which
)

depends+=(
  adobe-source-code-pro-fonts
  adobe-source-sans-fonts
  adobe-source-serif-fonts
  asciinema
  asciitosvg-git
  bash-bats
  bc
  bluez
  chromium
  cryptsetup
  device-mapper
  diffutils
  dosfstools # FAT filesystem utilities
  e2fsprogs
  fd
  firefox
  gimp
  gmni-git
  go
  go-yq
  gopls
  gron-bin
  hyperfine
  inetutils
  inkscape
  ldns
  libpipewire02 # older version needed for screen sharing in chromium
  libreoffice-fresh
  logrotate
  lvm2
  lxd
  man-db
  man-pages
  meson
  mitmproxy
  mtools # needed for syslinux to create an Arch installer on USB
  ncdu
  ninja
  nmap
  ntfs-3g
  oath-toolkit
  p7zip # extract ZIP archives using encryptions not supported by unzip
  pacman-contrib # needed for paccache service
  perl-authen-sasl # git email
  perl-net-smtp-ssl # git email
  perl-mime-tools # git email
  pipewire-media-session
  pipewire-pulse
  python-adblock
  shellcheck-bin
  s-nail
  speedtest-cli
  syslinux # needed to create an Arch installer on USB
  termshark
  tree
  unrar
  unzip
  usbutils
  vi
  wireguard-tools
  xdg-desktop-portal-wlr
  xorg-xwayland
  yt-dlp
  zathura-cb
  zathura-pdf-mupdf
  zip
)

_rootdir=$PWD

package_common() {
  cp -R "$_rootdir"/files/* "$pkgdir"
  chmod 0400  "$pkgdir"/etc/doas.conf
  chmod 700  "$pkgdir"/etc/NetworkManager/system-connections
  chmod 600  "$pkgdir"/etc/NetworkManager/system-connections/*
}

package_system-config-light() {
  depends+=(
    dotfiles-light-git
  )

  package_common

  ln -sf issue_light "$pkgdir"/etc/issue
}

package_system-config-dark() {
  depends+=(
    dotfiles-dark-git
  )

  package_common

  ln -sf issue_dark "$pkgdir"/etc/issue
}
